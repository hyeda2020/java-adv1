# 11. ExecutorService 우아한 종료
- 우아한 종료 : 서버 기능을 업데이트를 위해서 서버를 재시작해야 할 때,  
  새로운 요청이 오는 것은 막고, 이미 진행중인 작업이 모두 완료한 다음에 재시작 하는 것 처럼 문제 없이 서비스를 종료하는 것.  
  

- `ExecutorService` 의 종료 메서드
  - `void shutdown()` : 새로운 작업을 받지 않고, 이미 제출된 작업(BlockingQueue에 있는 작업들 포함)을 모두 완료한 후에 종료.  
  - `List<Runnable> shutdownNow()` : 실행 중인 작업을 중단하고, 대기 중인 작업을 반환하며 즉시 종료.
  - `close()` : shutdown() 을 호출하고, 작업이 완료되거나 인터럽트가 발생할 때 까지 무한정 반복 대기.

  
- `Executor` 스레드 풀 관리 : BlockingQueue와 스레드 풀 관리 예시(기본 스레드 2개, 최대 스레드 4개)
  - BlockingQueue Size = 2
  - corePoolSize = 2
  - maximumPoolSize = 4

  
- 스레드 미리 생성하기  
  응답시간이 아주 중요한 서버인 경우, 스레드를 미리 생성해두면, 처음 요청에서 사용되는 스레드의 생성 시간을 줄일 수 있음.  
  `ThreadPoolExecutor.prestartAllCoreThreads()` 를 사용하면 기본 스레드를 미리 생성할 수 있음.  
  단, `ExecutorService` 는 이 메서드를 제공하지 않음.  
  ```
  public static void main(String[] args) {
      ExecutorService es = Executors.newFixedThreadPool(1000);
      ThreadPoolExecutor poolExecutor = (ThreadPoolExecutor) es;
      poolExecutor.prestartAllCoreThreads();
  }
  ```