# 7. 생산자 소비자 문제 2  
- Lock Condition : 핵심은 생산자 스레드는 소비자 스레드에게, 반대로 소비자 스레드는 생산자 스레드에게 `notify` 를 해주면 됨.  
  이를 위해서는 결국 생산자 스레드가 대기하는 대기 집합과, 소비자 스레드가 대기하는 대기 집합을 둘로 나누면 해결 가능.  
  => `Lock`, `ReentrantLock` 을 활용하여 이러한 기능 구현.  

  ```
  public class BoundedQueueV5 implements BoundedQueue {
      private final Lock lock = new ReentrantLock();
      private final Condition producerCond = lock.newCondition(); // 생산자 대기 큐
      private final Condition consumerCond = lock.newCondition(); // 소비자 대기 큐
      private final Queue<String> queue = new ArrayDeque<>();
      private final int max;
  
      public BoundedQueueV5(int max) {
          this.max = max;
      }
  
      @Override
      public void put(String data) {
          lock.lock();
          try {
              while (queue.size() == max) {
                  try {
                      producerCond.await();
                  } catch (InterruptedException e) {
                      throw new RuntimeException(e);
                  }
              }
              queue.offer(data);
              consumerCond.signal();
          } finally {
              lock.unlock();
          }
      }
  
      @Override
      public String take() {
          lock.lock();
          try {
              while (queue.isEmpty()) {
                  try {
                      consumerCond.await();
                  } catch (InterruptedException e) {
                      throw new RuntimeException(e);
                  }
              }
              String data = queue.poll();
              producerCond.signal();
              return data;
          } finally {
              lock.unlock();
          }
      }
  }
  ```  
  - `put(data)` : 생산자 스레드가 호출  
    - 큐가 가득 찬 경우: `producerCond.await()` 를 호출해서 생산자 스레드를 생산자 전용 스레드 대기 공간에 보관.  
    - 데이터를 저장한 경우 : `consumerCond.signal()` 를 호출하여 소비자 전용 스레드 대기 공간에 있는 소비자 스레드 하나를 깨움.  
  - `take()` : 소비자 스레드가 호출  
    - 큐가 빈 경우 : `consumerCond.await()` 를 호출해서 소비자 스레드를 소비자 전용 스레드 대기 공간에 보관.  
    - 데이터를 소비한 경우 : `producerCond.signal()` 를 호출해서 생산자 전용 스레드 대기 공간에 있는 생산자 스레드 하나를 깨움.  
  